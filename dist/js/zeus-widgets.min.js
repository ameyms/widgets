/*!
 * Copyright (C) 2015, Symantec Corporation
 * All rights reserved.
 * zeus-widgets v0.0.1
 */
"use strict";angular.module("zeus.widgets",["ui.bootstrap","zeus.widgets.templates"]),angular.module("zeus.widgets").directive("btnAsync",[function(){var a,b,c='<div class="btn-async-spinner"><div class="dot bounce1"></div><div class="dot bounce2"></div><div class="dot bounce3"></div></div>';return b=function(a,b,d,e,f){var g=$(b);g.is("button")&&(f(function(a){var b=$('<span class="btn-async-text"></span>');g.html(c),b.append(a),g.append(b)}),a.$watch("indicateLoading",function(a){a?g.addClass("is-loading"):g.removeClass("is-loading")}))},a=function(a,b){b.on("click touchstart",function(b){a.indicateLoading&&(b.stopImmediatePropagation(),b.preventDefault())})},{restrict:"C",transclude:!0,link:{pre:a,post:b},scope:{indicateLoading:"=?"}}}]),angular.module("zeus.widgets").directive("zsCheckbox",function(){var a;return a=function(a){a.$watch("itemValue",function(){a.onValueChange()})},{templateUrl:"html/checkbox.html",restrict:"E",replace:!0,scope:{itemValue:"=",size:"@",onValueChange:"&?"},link:a}}),angular.module("zeus.widgets").directive("zsDropdown",function(){var a;return a=function(a,b,c){var d;angular.isDefined(c.multiSelect)&&(a.multiSelect=!0),d=function(b){var c=a.idGenerator({$item:b});angular.forEach(a.items,function(b){c===b.id?a.multiSelect?(b.isChecked=!0,++a.selectionCount):b.isChecked||(b.isChecked=!0,++a.selectionCount,a.selectedItem=b.textValue):a.multiSelect||b.isChecked&&(b.isChecked=!1,--a.selectionCount)})},a.defaultLabel||(a.defaultLabel="Select an item"),a.items=[],a.isOpen=!1,a.selectionCount=0,a.selectedItem=null,angular.forEach(a.listItems,function(b){var c={};c.item=b,c.textValue=a.labelGenerator({$item:b}),c.id=a.idGenerator({$item:b}),a.items.push(c)}),$(b).on("click."+a.$id,function(a){var c=$(b).find(".zs-dropdown-wrapper"),d=$(document).find(".zs-dropdown-wrapper"),e=!1;c.hasClass("is-active")&&(e=!0),angular.forEach(d,function(a){$(a).hasClass("is-active")&&$(a).removeClass("is-active")}),e||c.addClass("is-active"),a.stopPropagation()}),$(document).on("click."+a.$id,function(){var a=$(b).find(".zs-dropdown-wrapper");$(event.target).hasClass("zs-dropdown-wrapper")||a.hasClass("is-active")&&a.removeClass("is-active")}),a.$on("$destroy",function(){$(document).off("click."+a.$id),$(b).off("click."+a.$id)}),angular.isArray(a.zsModel)?a.$watchCollection("zsModel",function(){angular.forEach(a.items,function(b){a.multiSelect&&b.isChecked&&(b.isChecked=!1)}),angular.forEach(a.zsModel,function(a){d(a)})}):a.$watch("zsModel",function(a){a&&d(a)}),a.itemClick=function(b){if(angular.isArray(a.zsModel)){var c=a.zsModel.indexOf(b.item);-1===c?a.zsModel.push(b.item):a.zsModel.splice(c,1)}else a.zsModel=b.item,a.onItemClick({$selectedItem:b.item})}},{templateUrl:"html/zs_dropdown.html",restrict:"AE",scope:{listItems:"=",updateMenuLabel:"=?",labelGenerator:"&",idGenerator:"&",multiSelect:"@",defaultLabel:"@?",zsModel:"=?",onItemClick:"&?",fieldLabel:"=?"},link:a}}),angular.module("zeus.widgets").directive("zsFlipCard",["$timeout",function(a){var b;return b=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=$(c.find(".face-container")),r=$(window);f(function(a){var b;b=a.filter("div"),angular.forEach(b,function(a){switch(a=$(a),a.data("role")){case"front-face":l=a,n=a.data("heading");break;case"back-face":m=a,o=a.data("heading")}})}),q.find(".face-front").append(l),q.find(".face-front").find(".header h6").text(n),q.find(".face-back").append(m),q.find(".face-back").find(".header h6").text(o),angular.isDefined(d.hideFlipButton)?q.find(".flip-btn").hide():q.find(".flip-btn").click(function(){p()}),j=c.find(".face-front"),k=c.find(".face-back"),b.$watch("activeFace",function(a){var b=q.hasClass("is-flipped");if(a)switch(a){case"front":b&&p();break;case"back":b||p()}}),p=function(){var a=q.hasClass("is-flipped");q.toggleClass("is-flipped"),a?b.activeFace="front":b.activeFace="back"},h=function(){i()},i=function(){var a=k.height(),b=Math.max(j.outerHeight(),k.outerHeight());j.height(a),c.height(b+10)},r.on("resize.zs_flip_card_"+b.$id,function(){var b=c.is(":visible");g&&a.cancel(g),b&&(g=a(function(){h()},500))}),a(function(){i()})},{templateUrl:"html/flip_card.html",restrict:"E",transclude:!0,replace:!0,scope:{activeFace:"=?"},link:b}}]),angular.module("zeus.widgets").directive("zsRadioTabs",["$interpolate","$timeout",function(a,b){var c,d;return d=["$scope",function(a){a.deselectAll=function(){a.selection=null,a.ondeselect()},a.selectTab=function(b){a.selection=b.itemId}}],c=function(c,d,e,f,g){var h=[],i=$(d.find('[data-role="pane-holder"]'));g(function(d){var e,f=0;e=d.filter("zs-radio-tab-pane"),angular.forEach(e,function(b){var c;b=angular.element(b),c=b.attr("item"),h.push({heading:a(b.attr("heading"))(),subHeading:a(b.attr("subheading"))(),itemId:c})}),c.panes=h,b(function(){angular.forEach(e,function(a){var b;a=angular.element(a),b=i.find('[data-index="'+f+'"]'),b.append(a.contents()),f++})},0)})},{templateUrl:"html/radio_tabs.html",restrict:"E",transclude:!0,replace:!0,scope:{ondeselect:"&",selection:"="},controller:d,link:c}}]),angular.module("zeus.widgets").directive("zsSimpleToggle",[function(){return{templateUrl:"html/simple_toggle.html",restrict:"E",replace:!0,scope:{text:"@",state:"=?",lighten:"@",color:"@switchColor",zsChange:"&",inactive:"@"},link:function(a,b){var c,d,e,f,g=$(b),h=g.find('[data-role="icon"]');f=function(a,b){var c,d,e,f,g=!1;return"#"===a[0]&&(a=a.slice(1),g=!0),c=parseInt(a,16),d=(c>>16)+b,d>255?d=255:0>d&&(d=0),e=(c>>8&255)+b,e>255?e=255:0>e&&(e=0),f=(255&c)+b,f>255?f=255:0>f&&(f=0),(g?"#":"")+(f|e<<8|d<<16).toString(16)},c=function(){a.state=!a.state,a.zsChange&&a.zsChange(),d()},e=function(){h.css({borderColor:a.color}),g.css({borderColor:a.color}),g.click(function(){a.$apply(function(){c()})}),g.mouseover(function(){$(this).css({backgroundColor:f(a.color,+a.lighten)})}),g.mouseout(function(){$(this).css({backgroundColor:"#FFF"})})},d=function(){var b="#FFF";a.state?(g.addClass("state-on"),g.removeClass("state-off"),b=a.color):(g.addClass("state-off"),g.removeClass("state-on")),h.css({backgroundColor:b})},a.state=a.state||!1,a.inactive?g.addClass("state-inactive"):(d(),e()),a.$watch("state",function(){d()})}}}]),angular.module("zeus.widgets").directive("zsTableFragment",["$interpolate","$timeout","$q",function(a,b,c){var d,e;return e=function(a,b,c,d,e){var f=b.find("h3.external-header"),g=b.find(".card-body");e(function(a){var b=a.filter('[data-role="toolbar-item"]'),c=angular.element(a.filter("table"));b&&angular.forEach(b,function(a){a=angular.element(a),a.addClass("table-toolbar-item"),f.after(a)}),g.prepend(c)})},d=function(d,f,g,h,i){e(d,f,g,h,i);var j,k,l,m,n,o,p,q=f.find("table"),r=q.find("th[data-sort-key]"),s=q.find("th"),t=q.find("tbody"),u="fa-sort-asc",v="fa-sort-desc",w=f.find('[data-role="load-mask"]');w.show(),q.addClass("sortable"),j=function(){r.length&&(r.addClass("sort-active"),$.each(r,function(){var a=$(this),b="";a.attr("sort-default")&&(a.addClass(a.attr("sort-default")),"asc"===a.attr("sort-default")?(b=u,a.addClass("asc"),d.sortOn=a.data("sortKey"),p=a.data("sortKey")):"desc"===a.attr("sort-default")&&(b=v,a.addClass("desc"),d.sortOn="-"+a.data("sortKey"),p="-"+a.data("sortKey"))),a.append('<span class="fa '+b+' showCheckIcon" data-role="icon"></span>')}),o=q.find(".fa"),q.on("click","th",function(){var a=$(this),b=a.find(".fa");w.show(),o.removeClass(u).removeClass(v),a.hasClass("asc")?(a.toggleClass("asc desc"),b.addClass(v),d.$apply(function(){d.remoteSort?(p="-"+a.data("sortKey"),d.sortOn="-"+a.data("sortKey"),d.currentPage=1,d.loadPrevNextPage()):(d.sortOn="-"+a.data("sortKey"),w.hide())})):(a.removeClass("desc").addClass("asc"),b.addClass(u),d.$apply(function(){d.remoteSort?(p=a.data("sortKey"),d.sortOn=a.data("sortKey"),d.currentPage=1,d.loadPrevNextPage()):(d.sortOn=a.data("sortKey"),w.hide())}))}))},l=function(){d.isDragable&&t.sortable({opacity:.6,update:function(){var a,b=f.find('[data-role="load-mask"]');f.find('[data-role="load-mask"]').show(),a=d.onItemDrop(),a.then(function(){b.hide()},function(){b.hide(),t.sortable("cancel")})}}).disableSelection()},k=function(){var b=1;d.headers=[],$.each(s,function(){var c={},e=$(this),f=a(e.text())();c.label=f,c.selected=!0,c.columnNumber=b++,c.allowed_hide=e.data("allowed-hide")!==!1?!1:!0,c.isSortingEnabled=e.data("sortKey")?!0:!1,c.sortKey=e.data("sortKey"),"asc"===e.attr("sort-default")?c.className=u:"desc"===e.attr("sort-default")&&(c.className=v),d.headers.push(c)})},m=function(){var c,e,f=1,g="";b(function(){$.each(s,function(){c=a($(this).text())(),g='<span class="mobileColumnHeader">',g+=c+":",g+="</span>",e=t.find("td:nth-child( "+f+" )"),e.find(".mobileColumnHeader").remove(),e.prepend(g),f++}),t.find("tr").length||(d.loadingStatus="empty")},0)},n=function(){d.headerIcon=g.headerIcon,d.paginate=void 0!==g.paginate?!0:!1,d.paginateMarker=void 0!==g.paginateMarker?!0:!1,d.showAll=void 0!==g.showAll?!0:!1,d.remoteSort=void 0!==g.sortPaginateHandler?!0:!1,d.currentPage=1,(g.sortOn||g.sortPaginateHandler)&&j(),d.isDragable&&l(),k(),d.remoteSort?d.$watch("totalRecords",function(){d.totalRecords||d.loadPrevNextPage()}):c.when(d.isLoadingStatus()).then(function(){m(),w.hide()},function(){d.loadingStatus="failed",w.hide()})},d.showAllRecords=function(){d.toggleShowText?(d.paginate=!0,d.loadPrevNextPage()):(d.paginate=void 0,d.displayList=d.srcList),d.toggleShowText=!d.toggleShowText},d.hideColumn=function(a,b){b.selected=!b.selected,f.toggleClass("hideColumn"+a)},d.loadPrevNextPage=function(){var a,c="";w.show(),d.oldPageNumber&&(d.oldPageNumber>d.currentPage?c="prev":d.oldPageNumber<d.currentPage&&(c="next")),d.oldPageNumber=d.currentPage,a=d.sortPaginateHandler(d.paginateMarker?{pageState:c,recordsPerPage:d.displayLimit,sortParam:p}:{pageNumber:d.currentPage,recordsPerPage:d.displayLimit,sortParam:p}),a.then(function(){b(function(){t.find("tr").length||(d.loadingStatus="empty")},0),w.hide(),m()},function(){d.loadingStatus="failed",w.hide()})},n()},{templateUrl:"html/table_fragment.html",transclude:!0,replace:!0,restrict:"E",scope:{sortOn:"=?",heading:"@?",hidecolumn:"@?",isDragable:"@?",onItemDrop:"&?",displayLimit:"@?",sortPaginateHandler:"&?",totalRecords:"=?",isLoadingStatus:"&?"},controller:["$scope","$attrs",function(a,b){void 0!==b.extractHeader?a.extractHeader=!0:a.extractHeader=!1}],link:d}}]),angular.module("zeus.widgets").directive("zsText",function(){var a,b;return b=function(a,b){angular.isString(a)?b.validation.msg=a:a.then(function(a){b.validation.msg=a})},a=function(a,c,d){var e,f,g,h=$(c[0]),i=h.find('[data-role="icon"]');a.validation={msg:" ",level:null,inprogress:!1},angular.isString(d.mandatory)&&(a.mandatory=!0),e=function(){a.validation.msg=" ",a.validation.level="success",a.validation.inprogress=!1,a.isInvalid=!1},f=function(c){i.show(),b(c,a),a.validation.level="warning",a.validation.inprogress=!1,a.isInvalid=!1},g=function(c){i.show(),b(c,a),a.validation.level="error",a.validation.inprogress=!1,a.isInvalid=!0},a.validationHandler=function(){var b=h.find("input")[0].value,c=a.validateValue({$val:b});if(a.validation.msg=" ",a.validation.level="",a.validation.inprogress=!0,!c)return void e();if(angular.isString(c))return void g(c);if(c.level&&c.msg)switch(c.level){case"warning":f(c.msg);break;case"error":g(c.msg)}c.then(function(a){return angular.isString(a)?void g(a):void e()},function(a){if(angular.isString(a))return void g(a);switch(a.level){case"warning":f(a.msg);break;case"error":g(a.msg)}})}},{templateUrl:"html/zs_text.html",replace:!0,restrict:"E",scope:{validateValue:"&validator",placeholder:"@",showTick:"@",isInvalid:"=",label:"@",zsModel:"=?",isDisabled:"=?"},link:a}});